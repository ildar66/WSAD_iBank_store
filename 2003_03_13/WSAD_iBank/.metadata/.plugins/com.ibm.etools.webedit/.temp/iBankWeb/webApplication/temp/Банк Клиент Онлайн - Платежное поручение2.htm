<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0067)http://banking.guta.ru/cb_demo/pp.asp?formid=1&docid=377321&fetch=1 -->
<HTML><HEAD>
<BASE href="file:///C:/WSAD_iBank/iBankWeb/webApplication/temp/Банк Клиент Онлайн - Платежное поручение2.htm"><TITLE>Банк Клиент Онлайн - Платежное поручение</TITLE>
<LINK 
href="file:///C:/WSAD_iBank/.metadata/.plugins/com.ibm.etools.webedit/.temp/iBankWeb/webApplication/temp/Банк Клиент Онлайн - Платежное поручение2_files/cb.css" type=text/css 
rel=stylesheet>
<SCRIPT language=javascript 
src="Банк Клиент Онлайн - Платежное поручение2_files/common.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=JavaScript1.2 type=text/javascript>
window.onbeforeunload = unloadCheck;
window.setTimeout('window.onbeforeunload=null', 60000 * 10);
function unloadCheck()
{
	if(event.clientX > document.body.clientWidth && event.clientY < 0)
		return 'Внимание!\nДля выхода из системы \'Банк Клиент Онлайн\' воспользуйтесь пунктом меню \'Выход\'.';
	else
		return;
}
</SCRIPT>

<META content="MSHTML 6.00.2712.300" name=GENERATOR></HEAD>
<BODY>
<TABLE cellSpacing=0 cellPadding=0 width="100%" 
background="Банк Клиент Онлайн - Платежное поручение2_files/bgtop.gif" 
  border=0><TBODY>
  <TR>
    <TD width=171><A href="http://www.guta.ru/" target=Gutf><IMG height=51 
      alt="ГУТА БАНК" 
      src="Банк Клиент Онлайн - Платежное поручение2_files/logo.gif" width=171 
      border=0></A></TD>
    <TD class=toptitle>• Банк Клиент Онлайн • Тестовый филиал • ООО "Все в 
      порядке"</TD>
    <TD class=toptitle align=right>• <A class=topmenu 
      href="javascript:openHelp(window.location,'');">справка</A>&nbsp; 
  </TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" 
background="Банк Клиент Онлайн - Платежное поручение2_files/hr2.gif" border=0>
  <TBODY>
  <TR>
    <TD width=120 
    background="Банк Клиент Онлайн - Платежное поручение2_files/hr1.gif"><IMG 
      height=15 alt="" 
      src="Банк Клиент Онлайн - Платежное поручение2_files/zagl1.gif" 
    width=18></TD>
    <TD>&nbsp;</TD></TR></TBODY></TABLE>
<TABLE height="100%" cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD width=10 bgColor=#dcdee0>&nbsp;</TD>
    <TD class=menu width=110 bgColor=#dcdee0><A 
      href="http://banking.guta.ru/cb_demo/client.asp">Клиент</A><BR><A 
      href="http://banking.guta.ru/cb_demo/accounts.asp">Счета</A><BR><A 
      class=current 
      href="http://banking.guta.ru/cb_demo/documents.asp">Документы</A><BR><A 
      href="http://banking.guta.ru/cb_demo/statements.asp">Выписки</A><BR><A 
      href="http://banking.guta.ru/cb_demo/references.asp">Справочники</A><BR><A 
      href="http://banking.guta.ru/cb_demo/messages.asp">Сообщения</A><BR><A 
      href="http://banking.guta.ru/cb_demo/reports.asp">Отчеты</A><BR><A 
      href="http://banking.guta.ru/cb_demo/setup.asp">Настройки</A><BR><A 
      href="http://banking.guta.ru/cb_demo/logout.asp">Выход</A><BR></TD>
    <TD>
      <DIV class=title>Платежное поручение</DIV>
      <DIV class=body><!-- -->
      <SCRIPT language=javascript 
      src="Банк Клиент Онлайн - Платежное поручение2_files/validate.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT language=javascript 
      src="Банк Клиент Онлайн - Платежное поручение2_files/form.js" 
      type=text/javascript></SCRIPT>

      <FORM name=docform action=formaction.asp method=post autocomplete="off"><!-- BEGIN BACKGROUND TABLE -->
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=docbg><!-- BEGIN LAYOUT TABLE -->
            <TABLE class=doclayout cellSpacing=1 cellPadding=2 border=0>
              <TBODY>
              <TR>
                <TD colSpan=5>
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD noWrap rowSpan=2>ПЛАТЕЖНОЕ ПОРУЧЕНИЕ №&nbsp;<INPUT 
                        title=Номер maxLength=10 size=10 value=664 name=docnum> 
                      </TD>
                      <TD align=middle><INPUT title=Дата type=hidden 
                        value=07/10/2002 name=docdate><INPUT title=Дата.День 
                        maxLength=2 onchange=date_onchange(this) size=2 value=07 
                        name=docdatedd><INPUT title=Дата.Месяц maxLength=2 
                        onchange=date_onchange(this) size=2 value=10 
                        name=docdatemm><INPUT title=Дата.Год maxLength=4 
                        onchange=date_onchange(this) size=4 value=2002 
                        name=docdateyy> </TD>
                      <TD align=middle><SELECT title="Вид платежа" size=1 
                        name=paykind><OPTION></OPTION><OPTION 
                          selected>электронно</OPTION><OPTION>телеграфом</OPTION><OPTION>почтой</OPTION></SELECT> 
                      </TD></TR>
                    <TR>
                      <TD align=middle>Дата </TD>
                      <TD align=middle>Вид платежа </TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD rowSpan=2>ИНН&nbsp;<INPUT class=disabled 
                  title="ИНН Плательщика" readOnly maxLength=12 size=14 
                  value=2901068336 name=payerinn><BR><TEXTAREA onkeypress="if(this.value.length>=160) event.returnValue=false;" onpaste="this.value=(this.value+window.clipboardData.getData('Text')).substr(0,160);;event.returnValue=false;" title="Наименование Плательщика" name=payer rows=3 cols=30 onchange=this.value=this.value.substr(0,160);>ООО "Все в порядке"</TEXTAREA><BR>Плательщик 
                </TD>
                <TD>Сумма </TD>
                <TD colSpan=3><INPUT title=Сумма maxLength=18 size=18 
                  value=123000.00 name=docsum> </TD></TR>
              <TR>
                <TD>Сч. № </TD>
                <TD colSpan=3><SELECT title="Счет Плательщика" size=1 
                  name=payeracc><OPTION 
                  selected>40702810500390000113</OPTION></SELECT><INPUT 
                  id=knfout 
                  style="BORDER-TOP-STYLE: none; BORDER-RIGHT-STYLE: none; BORDER-LEFT-STYLE: none; BACKGROUND-COLOR: transparent; BORDER-BOTTOM-STYLE: none" 
                  disabled size=1> </TD></TR>
              <TR>
                <TD rowSpan=2><TEXTAREA class=disabled title="Наименование Банка плательщика" name=payerbank rows=3 readOnly cols=30>ЗАО КБ "ГУТА-БАНК" Г. Москва</TEXTAREA><BR>Банк 
                  плательщика </TD>
                <TD>БИК </TD>
                <TD colSpan=3><INPUT class=disabled 
                  title="БИК Банка плательщика" readOnly maxLength=9 size=10 
                  value=044525716 name=payerbic> </TD></TR>
              <TR>
                <TD>Сч. № </TD>
                <TD colSpan=3><INPUT class=disabled 
                  title="Корсчет Банка плательщика" readOnly maxLength=20 
                  size=23 value=30101810100000000716 name=payercoracc> </TD></TR>
              <TR>
                <TD rowSpan=2><TEXTAREA class=disabled title="Наименование Банка получателя" name=receiverbank rows=3 readOnly cols=30>АРХАНГЕЛЬСКОЕ ОСБ N 8637 Г. АРХАНГЕЛЬСК</TEXTAREA><BR>Банк 
                  получателя </TD>
                <TD>БИК </TD>
                <TD colSpan=3><INPUT title="БИК Банка получателя" maxLength=9 
                  size=10 value=041117601 name=receiverbic>&nbsp;<INPUT class=ref id=receiverbicref title="Справочник Банков" onclick="CallRef(document.docform,1,'receiverbic,-receiverbank,-receivercoracc')" type=button value=">"> 
                </TD></TR>
              <TR>
                <TD>Сч. № </TD>
                <TD colSpan=3><INPUT class=disabled 
                  title="Корсчет Банка получателя" readOnly maxLength=20 size=23 
                  value=30101810100000000601 name=receivercoracc> </TD></TR>
              <TR>
                <TD vAlign=bottom rowSpan=4>ИНН&nbsp;<INPUT 
                  title="ИНН Получателя" maxLength=12 size=14 value=2901069795 
                  name=receiverinn>&nbsp;<INPUT class=ref id=receiverref title="Справочник Корреспондентов" onclick="CallRef(document.docform,2,'receiver,receiverinn,receiveracc,receiverbic,receiverbank,receivercoracc')" type=button value=">"><BR><TEXTAREA onkeypress="if(this.value.length>=160) event.returnValue=false;" onpaste="this.value=(this.value+window.clipboardData.getData('Text')).substr(0,160);;event.returnValue=false;" title="Наименование Получателя" name=receiver rows=3 cols=30 onchange=this.value=this.value.substr(0,160);>Подвинье ООО</TEXTAREA><BR>Получатель 
                </TD>
                <TD>Сч. № </TD>
                <TD colSpan=3><INPUT title="Счет получателя" maxLength=20 
                  size=23 value=40702810004022467345 name=receiveracc><INPUT 
                  id=knfin 
                  style="BORDER-TOP-STYLE: none; BORDER-RIGHT-STYLE: none; BORDER-LEFT-STYLE: none; BACKGROUND-COLOR: transparent; BORDER-BOTTOM-STYLE: none" 
                  disabled size=1> </TD></TR>
              <TR>
                <TD>Вид. оп.&nbsp; </TD>
                <TD><INPUT class=disabled readOnly size=2 value=01 
                  name=opkind> </TD>
                <TD>Срок плат. </TD>
                <TD><INPUT title="Срок платежа" type=hidden 
                  name=paydate><INPUT class=disabled title="Срок платежа.День" 
                  readOnly maxLength=2 onchange=date_onchange(this) 
                  size=2><INPUT class=disabled title="Срок платежа.Месяц" 
                  readOnly maxLength=2 onchange=date_onchange(this) 
                  size=2><INPUT class=disabled title="Срок платежа.Год" readOnly 
                  maxLength=4 onchange=date_onchange(this) size=4> </TD></TR>
              <TR>
                <TD>Наз. пл. </TD>
                <TD>&nbsp; </TD>
                <TD>Очер. плат. </TD>
                <TD><SELECT size=1 
                    name=paypriority><OPTION>1</OPTION><OPTION>2</OPTION><OPTION>3</OPTION><OPTION>4</OPTION><OPTION 
                    selected>5</OPTION><OPTION>6</OPTION></SELECT> </TD></TR>
              <TR>
                <TD>Код </TD>
                <TD>&nbsp; </TD>
                <TD>Рез. поле </TD>
                <TD>&nbsp; </TD></TR>
              <TR>
                <TD colSpan=5>
                  <TABLE cellSpacing=0 cellPadding=0 border=0>
                    <TBODY>
                    <TR>
                      <TD>Ставка НДС&nbsp;</TD>
                      <TD><INPUT maxLength=6 onchange=tax_calc() size=6 
                        value=20.00 name=taxrate></TD>
                      <TD>&nbsp;Сумма НДС&nbsp;</TD>
                      <TD><INPUT maxLength=18 size=18 value=0.00 
                      name=taxsum></TD>
                      <TD>&nbsp;<INPUT class=btn onclick=addtax_onclick() type=button value=Вставить name=addtax></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=5>Назначение платежа<BR>
                  <TABLE id=knfdiv style="DISPLAY: none" cellSpacing=0 
                  cellPadding=0 border=0>
                    <TBODY>
                    <TR>
                      <TD>Цифровое обозначение операции&nbsp;(KNF)&nbsp;</TD>
                      <TD><INPUT class=disabled 
                        title="Цифровое обозначение операции согласно инструкции ЦБР № 93-И" 
                        readOnly maxLength=3 size=3 name=knf>&nbsp;<INPUT class=ref id=knfref title="Справочник операций по счетам типа К, Н, Ф" onclick="CallRef(document.docform,15,'knf,,*knfin,*knfout')" type=button value=">"></TD></TR></TBODY></TABLE><TEXTAREA onkeypress="if(this.value.length>=210) event.returnValue=false;" onpaste="this.value=(this.value+window.clipboardData.getData('Text')).substr(0,210);;event.returnValue=false;" title="Назначение платежа" name=paypurpose rows=3 cols=63 onchange=this.value=this.value.substr(0,210);>Оплата информ. услуг Сумма: 123000-00, в т.ч. НДС(20.00%): 20500-00.</TEXTAREA> 
                </TD></TR>
              <TR>
                <TD colSpan=5>Комментарий к документу<BR><TEXTAREA onkeypress="if(this.value.length>=200) event.returnValue=false;" onpaste="this.value=(this.value+window.clipboardData.getData('Text')).substr(0,200);;event.returnValue=false;" title=Комментарий name=attention rows=1 cols=63 onchange=this.value=this.value.substr(0,200);></TEXTAREA> 
                </TD></TR></TBODY></TABLE><!-- END LAYOUT TABLE --><INPUT 
            type=hidden value=RUR name=curcode> </TD></TR>
        <TR>
          <TD align=middle>статус документа: отправлен </TD></TR></TBODY></TABLE><!-- END BACKGROUND TABLE --><INPUT type=hidden 
      value=1 name=formid> <INPUT type=hidden value=377321 name=docid> <INPUT 
      type=hidden name=btnsubmit> <!--
<INPUT class=btn type=button value="Копировать" onclick="document_copy(this);">
--><NOBR><INPUT class=btn style="WIDTH: 180px" onclick=pattern_save(this); type=button value="Сохранить как шаблон"> 
      <INPUT maxLength=255 name=patterntitle> </NOBR></FORM>
      <SCRIPT language=javascript>

var theForm = document.docform;

var knfacc = new Array();knfacc[30122] = 'К';knfacc[30123] = 'Н';knfacc[40813] = 'Ф';knfacc[40814] = 'К';knfacc[40815] = 'Н';

function getknfacc(acc, knf)
{
	var s = knfacc[field_get(acc).substr(0, 5)];
	var tmpknf = knf.value;
	knf.value = s?s:'';
	return (tmpknf != knf.value);
}

// payeracc
theForm.payeracc.onchange = payeracc_onchange;
getknfacc(theForm.payeracc, theForm.knfout);
function payeracc_onchange()
{
	if(getknfacc(theForm.payeracc, theForm.knfout))
		knfacc_change();
}

// receiveracc
theForm.receiveracc.onchange = receiveracc_onchange;
getknfacc(theForm.receiveracc, theForm.knfin);
function receiveracc_onchange()
{
	if(getknfacc(theForm.receiveracc, theForm.knfin))
		knfacc_change();
}

// knfacc_change
function knfacc_change()
{
	with(theForm)
	{
	var b = knfin.value == '' && knfout.value == '';
	knfdiv.style.display = b?'none':'block';
	knf.value = '';
	}
}

// refselect
theForm.onrefselect = refselect;
function refselect(id)
{
	if(id == 2) receiveracc_onchange();
}

// tax
theForm.docsum.onchange = tax_calc;
tax_calc();
function tax_calc()
{
	with(theForm)
	{
	var sum = parseFloat(docsum.value) * parseFloat(taxrate.value) / (100 + parseFloat(taxrate.value));
	if(!isNaN(sum))
		taxsum.value = money_format(sum, '.');
	}
}

// addtax
function addtax_onclick()
{
	with(theForm)
	{
	var sum = parseFloat(docsum.value);
	var tax = parseFloat(taxsum.value);
	var rate = parseFloat(taxrate.value);
	var text = 'Сумма: ' + money_format(sum, '-') +  ', ';
	if(tax > 0)
		text += 'в т.ч. НДС(' + money_format(rate, '.') + '%): ' + money_format(tax, '-');
	else
		text += 'НДС не облагается';
	if(!isNaN(sum) && !isNaN(tax) && !isNaN(rate))
		paypurpose.value += ' ' + text + '.';
	}
}

function docform_onsubmit()
{
	with(theForm)
	{
	with(payerbic) if(value.length == 8) value = '0' + value;
	with(receiverbic) if(value.length == 8) value = '0' + value;
	if(!field_check(theForm.docnum,null,3,true)) return false;
	if(!field_check(theForm.docdate,null,7,true)) return false;
	if(!field_check(theForm.paykind,null,8,false)) return false;
	if(!field_check(theForm.docsum,null,6,true)) return false;
	if(!field_check(theForm.payerinn,null,8,false)) return false;
	if(!field_check(theForm.payeracc,null,8,true)) return false;
	if(!field_check(theForm.payer,null,8,true)) return false;
	if(!field_check(theForm.payerbic,null,8,true)) return false;
	if(!field_check(theForm.payercoracc,null,8,true)) return false;
	if(!field_check(theForm.payerbank,null,8,true)) return false;
	if(!field_check(theForm.receiverbic,null,8,true)) return false;
	if(!field_check(theForm.receivercoracc,null,8,false)) return false;
	if(!field_check(theForm.receiverbank,null,8,true)) return false;
	if(!field_check(theForm.receiverinn,null,8,false)) return false;
	if(!field_check(theForm.receiveracc,null,8,true)) return false;
	if(!field_check(theForm.receiver,null,8,true)) return false;
	if(!field_check(theForm.opkind,null,3,true)) return false;
	if(!field_check(theForm.paydate,null,7,false)) return false;
	if(!field_check(theForm.paypriority,null,3,true)) return false;
	if(!field_check(theForm.paypurpose,null,8,true)) return false;
	if(!field_check(theForm.curcode,null,8,false)) return false;
	if(!field_check(theForm.attention,null,8,false)) return false;

	if(parseInt(docnum.value) == 0)
		return field_alert(docnum, 'Поле должно быть больше нуля.');

	if(field_get(payerbic).substr(0,4) == field_get(receiverbic).substr(0,4) && paykind.selectedIndex != 0)
		return field_alert(paykind);

	if(!docdate_check(docdate))
		return false;
	
	if(parseFloat(docsum.value) == 0)
		return field_alert(docsum, 'Поле должно быть больше нуля.');
	
	var errkey = 'Неправильный ключ.';
	
	if(!isINN(payerinn.value))
		if(!field_warn(payerinn, errkey)) return false;

	if(!isAccount(payerbic.value, field_get(payeracc)))
		return field_alert(payeracc, errkey);
	
	if(!isINN(receiverinn.value))
		if(!field_warn(receiverinn, errkey)) return false;

	var re = /[^ -~А-я\n\r]+/;

	if(receiver.value.length < 2)
			return field_alert(receiver);
	if(re.exec(receiver.value) != null)
			return field_alert(receiver, 'Недопустимый символ \'' + RegExp.input.charAt(RegExp.index) + '\'.');
	
	if(receiveracc.value.length > 0)
	{
		if(!isAccount(receiverbic.value, field_get(receiveracc)))
			return field_alert(receiveracc, errkey);
		if(field_get(receiveracc).substring(5, 8) != '810')
			return field_alert(receiveracc, 'Укажите рублевый счет.');
		if(field_get(receiveracc) == field_get(payeracc))
			return field_alert(receiveracc, 'Счет получателя должен отличатся от счета плательщика.');
	}

	if(paypurpose.value.length < 2)
		return field_alert(paypurpose);
	if(re.exec(paypurpose.value) != null)
		return field_alert(paypurpose, 'Недопустимый символ \'' + RegExp.input.charAt(RegExp.index) + '\'.');

	var knfflag = knfin.value != '' || knfout.value != '';
	if(knfflag)
		if(!field_check(knf,null,3,true))
			return false;
	if(knfflag && paypurpose.value.search(/knf/i) >= 0)
		return field_alert(paypurpose, '\'' + knf.title + '\' необходимо указывать в соответсвующем поле.');
	if(knf.value != '')
		paypurpose.value = knf.value + 'KNF ' + paypurpose.value.replace(/^ +/, '');

	}
	return true;
}
</SCRIPT>
<!-- --></DIV></TD></TR></TBODY></TABLE></BODY></HTML>
